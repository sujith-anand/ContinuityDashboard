(self.webpackChunkcontrol=self.webpackChunkcontrol||[]).push([[8558],{39026:function(t,a,e){"use strict";var n=e(70719),o=e(4523);a.A=function(t,a){var e=o.Ay.template('<div class="row"><div class="alert alert-dismissible fade show alert-{{ key }} js--ajax-flash-message"><button type="button" class="close" data-dismiss="alert"><i class="fal fa-times"></i></button>{{ value }}</div></div>'),s=(0,n.A)(e({key:t,value:a}));(0,n.A)("#flash").html(s),"success"!==t&&"info"!==t||window.setTimeout((function(){s.find(".alert").alert("close")}),7500)},(0,n.A)((function(){window.setTimeout((function(){(0,n.A)(".alert-success.js--flash-message, .alert-info.js--flash-message").alert("close")}),7500)}))},31653:function(t,a,e){"use strict";var n=e(70719),o=e(21391),s=o.View.extend({open:function(t,a){var o=(0,n.A)(e(47075)()),s=window.innerHeight-200,i=(0,n.A)("<iframe/>",{allowfullscreen:null,class:"assignment-modal",frameborder:0,height:s+"px",hspace:0,mozallowfullscreen:null,name:"assignment-modal",scrolling:"auto",src:t,vspace:0,webkitallowfullscreen:null,width:"100%"});t.match(/\/edit/gi)&&o.find("[data-dismiss=modal]").on("click",this.confirmCancelModal),o.one("hidden.bs.modal",(function(t){(0,n.A)(t.currentTarget).modal("dispose"),(0,n.A)(t.currentTarget).remove()})),n.A.ajax({type:"HEAD",async:!0,url:t}).done((function(){(0,n.A)(".assignment-modal").length>0||(i.appendTo(o.find(".modal-body")).on("load",(function(t){var a=(0,n.A)(t.target).contents().find(".modal-title").html();o.find(".modal-title").html(a),o.modal("show")})),o.appendTo("body"),"function"===typeof a&&a())}))},confirmCancelModal:function(t){window.confirm("This ToDo is about to be closed and all unsaved work will be lost. Click Cancel to return to the ToDo. Click OK to close the ToDo without saving work.")||(t.stopPropagation(),t.preventDefault())}});a.A=s},70719:function(t,a,e){"use strict";var n=e(82726),o=e.n(n);e(67484);a.A=o()},81047:function(t,a,e){"use strict";var n=e(70719),o=e(4523),s=e(21391),i=e.n(s),d=e(66134),r=e(39026),l=e(31653),c=s.View.extend({events:{"control:todo:done":"handleToDoDone","control:todo:saved_for_later":"handleSavedForLater","click .one_click_comply_link":"handleExpressToDo","ajax:success .delete-on-demand":"handleDeleteOnDemandToDo","ajax:success .claim-assignment":"handleClaimAssignment","ajax:error .claim-assignment":"handleClaimAssignmentError","ajax:success form.on_demand_todo":"handleCreateOnDemandToDo"},initialize:function(t){this.isStrikethrough=(0,n.A)("div[data-strikethrough]").data("strikethrough"),this.assignmentTabId="tab--assignment",this.$assignmentTab=(0,n.A)("div #"+this.assignmentTabId),this.$badge=(0,n.A)('a[data-target="#'+this.assignmentTabId+'"]').find(".badge"),this.upperLimit=99},slideUpCompletedToDo:function(t){var a=this;t.one("hidden.bs.collapse",(function(){t.remove(),a._drawBadges()})),setTimeout((function(){t.collapse("hide")}),1e3)},handleToDoDone:function(t){var a=t.assignmentId,e=(0,n.A)(t.assignmentHtml),o=(0,n.A)('[data-todo-id="'+a+'"]'),s=e.find("[data-assignment-href]"),i=e.find("[data-to-do-history-row]");(0,n.A)(".modal.show").modal("hide"),this._updateDashboard(o,s,i)},handleExpressToDo:function(t){var a=this;n.A.ajax({url:t.target.href,context:t.target,type:"PUT",success:function(e,o,s){var i=(0,n.A)(e),d=(0,n.A)(t.target).closest("[data-assignment-href]"),r=i.find("[data-assignment-href]"),l=i.find("[data-to-do-history-row]");a._updateDashboard(d,r,l)},error:function(t,a,e){(0,r.A)("danger","Oops, something went wrong")}}),t.preventDefault()},handleDeleteOnDemandToDo:function(t){var a=t.detail,e=(a[0],a[1],a[2],(0,n.A)(t.target).closest("[data-todo-id]"));this.slideUpCompletedToDo(e)},handleSavedForLater:function(t){var a=t.assignmentId,e=(0,n.A)('[data-todo-id="'+a+'"]');(0,n.A)(".modal.show").modal("hide"),e.find("a.btn").text("Finish This")},_drawBadges:function(){var t=this.$assignmentTab.find("[data-todo-id]").length-this.$assignmentTab.find(".finished[data-todo-id]").length;t>this.upperLimit?this.$badge.html(this.upperLimit+"+"):t>0?this.$badge.html(t):this.$badge.html("")},_updateDashboard:function(t,a,e){var n=window.FooTable.get("#to_do_history");t.replaceWith(a),this.isStrikethrough||this.slideUpCompletedToDo(a),n&&n.rows.load(e,!0),this._drawBadges()},handleClaimAssignment:function(t){var a=t.detail,e=a[0],o=(a[1],a[2],(0,n.A)(e).find("[data-edit-assignment-href]")),s=o.data("edit-assignment-href"),i=this;(new l.A).open(s,(function(){(0,n.A)(t.target).closest("[data-edit-assignment-href]").replaceWith(o),i._drawBadges()}))},handleClaimAssignmentError:function(t){var a=t.detail,e=a[0];a[1],a[2];alert(e)},handleCreateOnDemandToDo:function(t){var a=t.detail,e=a[0],o=(a[1],a[2],(0,n.A)(e).find("[data-edit-assignment-href]")),s=(0,n.A)("div#tab--assignment div.assignments"),i=o.data("edit-assignment-href"),d=(0,n.A)("div#tab--assignment .alert-info"),r=this;(new l.A).open(i,(function(){o.appendTo(s),d.alert("close"),r._drawBadges()}))}});(0,n.A)((function(){var t=(0,n.A)(document);new d.A,i().History.started||i().history.start(),new c({el:t}),(0,n.A)(document).on("tabsrouter:ajaxloaded",(function(){(0,n.A)(".to_do_count_by_organization[data-json]").each((function(t,a){var s=(0,n.A)(a),i=s.data("json"),d=(0,o.Ay)(i).map((function(t){return t[0].toString()})),r=(0,o.Ay)(i).map((function(t){return t[1]})),l={title:{text:s.data("chart-title")},subtitle:{text:s.data("chart-subtitle")},chart:{renderTo:a,defaultSeriesType:"column"},series:[{name:"Counts",data:r,showInLegend:!1}],yAxis:{min:0,max:100,title:{text:"ToDo Count"}},xAxis:{categories:d,title:{text:"Organization"},labels:{rotation:-45,align:"right"}},legend:{enabled:!0}};Promise.all([e.e(8096),e.e(9558),e.e(4016)]).then(e.bind(e,10500)).then((function(t){new t.default.Chart(l)}))}))}))}))},66134:function(t,a,e){"use strict";var n=e(70719),o=e(21391),s=e.n(o),i=s().Router.extend({routes:{"tab/:tab":"showTab",":tab":"showTab","":"showFirstTab"},showTab:function(t){(0,n.A)('.nav-tabs a[data-target="#'+t+'"]').tab("show"),(0,n.A)('.nav-tabs a[data-target="#'+t+'"]').trigger("tabsrouter:showtab"),(0,n.A)('.nav-tabs a[data-target="#tab--'+t+'"]').tab("show"),(0,n.A)('.nav-tabs a[data-target="#tab--'+t+'"]').trigger("tabsrouter:showtab")},showFirstTab:function(){(0,n.A)(".nav-tabs a").first().tab("show").trigger("tabsrouter:showtab")}});(0,n.A)(document).on("tabsrouter:showtab",'a[data-toggle="tab"][data-url]',(function(t){var a=(0,n.A)(t.target),e=a.data("url"),o=(0,n.A)(a.data("target"));a.data("ajaxrequested")||(o.html('<div class="text-center mt-3 mb-3"><i class="fal fa-spinner fa-spin fa-2x fa-fw"></i><span class="sr-only">Loading...</span></div>'),a.data("ajaxrequested",!0),n.A.get(e).done((function(t){o.html(t),o.find(".footable").controlFooTable(),a.trigger("tabsrouter:ajaxloaded")})))})),(0,n.A)(document).on("click",'.nav-tabs a[data-toggle="tab"]',(function(t){var a=t.currentTarget.hash;s().history.navigate(a,{trigger:!0})})),a.A=i},47075:function(module){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="modal fade" data-backdrop="static" tabindex="-1" role="dialog" aria-hidden="true">\n  <div class="modal-dialog modal-xl" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h2 class="modal-title"></h2>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body" style="padding: 0"></div>\n      \x3c!--\n      <div class="modal-footer">\n        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\n        <button type="button" class="btn btn-primary">Understood</button>\n      </div>\n      --\x3e\n    </div>\n  </div>\n</div>\n';return __p}},62206:function(){}},function(t){var a=function(a){return t(t.s=a)};t.O(0,[8096],(function(){return a(81047),a(62206)}));t.O()}]);
//# sourceMappingURL=users_dashboard-fc8c943e82bd55386303.js.map